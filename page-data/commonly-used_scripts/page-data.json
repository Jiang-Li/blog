{"componentChunkName":"component---src-templates-blog-post-js","path":"/commonly-used_scripts/","webpackCompilationHash":"33ec1642eb905f0acb1e","result":{"data":{"site":{"siteMetadata":{"title":"Dynatic Data","author":"Jiang Li"}},"markdownRemark":{"id":"914740d3-16dc-5a94-a9b2-78644221d34d","excerpt":"I often use R, Python, SAS, SQL, and Bash in different\ntasks at the same time. To make the switch between different languages easier, I built a list of the…","html":"<p>I often use R, Python, SAS, SQL, and Bash in different\ntasks at the same time. To make the switch between different languages easier, I built a list of the commonly-used script for a quick reference.</p>\n<p>A simulated sample data set with missing values and duplicated values was used. </p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">set.seed<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nN <span class=\"token operator\">&lt;-</span> <span class=\"token number\">1000</span>\ndf <span class=\"token operator\">&lt;-</span> tibble<span class=\"token punctuation\">(</span>\ndimension1 <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"II\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"III\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">,</span> replace <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\ndimension2 <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">,</span> replace <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\nmeasure1 <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">,</span> replace <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\nmeasure2 <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">,</span> replace <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">&lt;-</span> as_tibble<span class=\"token punctuation\">(</span>lapply<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> \n                       <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span> \n                         r<span class=\"token punctuation\">[</span>sample<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">NA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                                  prob <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0.85</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                                  size <span class=\"token operator\">=</span> length<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                                  replace <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n                       <span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">)</span>\n\nhead<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 6 x 4\n##   dimension1 dimension2 measure1 measure2\n##   &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n## 1 I          &lt;NA&gt;              7        7\n## 2 III        B                 3        8\n## 3 I          A                 4       10\n## 4 II         &lt;NA&gt;              7        3\n## 5 I          A                 9        1\n## 6 III        A                10       NA</code></pre></div>\n<h2>Row and Column</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># row count</span>\nnrow<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## [1] 1000</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">df <span class=\"token percent-operator operator\">%>%</span> count<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1 x 1\n##       n\n##   &lt;int&gt;\n## 1  1000</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># column names</span>\nnames<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## [1] &quot;dimension1&quot; &quot;dimension2&quot; &quot;measure1&quot;   &quot;measure2&quot;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># data types</span>\nlapply<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> class<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## $dimension1\n## [1] &quot;character&quot;\n## \n## $dimension2\n## [1] &quot;character&quot;\n## \n## $measure1\n## [1] &quot;integer&quot;\n## \n## $measure2\n## [1] &quot;integer&quot;</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># row count</span>\ndf<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># column names</span>\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\"># data types</span>\ndf<span class=\"token punctuation\">.</span>dtypes  </code></pre></div>\n<h3>SAS</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PROC CONTENTS DATA=df;\nRUN;</code></pre></div>\n<h3>SQL</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">/* row count */</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> df \n\n<span class=\"token comment\">/* column names */</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">TOP</span> <span class=\"token number\">0</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> df \n\n<span class=\"token comment\">/* data types */</span>  \n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> INFORMATION_SCHEMA<span class=\"token punctuation\">.</span><span class=\"token keyword\">COLUMNS</span>  </code></pre></div>\n<h3>Bash</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># row count</span>\n<span class=\"token function\">wc</span> -l  filename \n\n<span class=\"token comment\"># column names</span>\n<span class=\"token function\">head</span> -1 filename </code></pre></div>\n<h2>Missing Values</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># count missing by columns</span>\ncolSums<span class=\"token punctuation\">(</span>is.na<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## dimension1 dimension2   measure1   measure2 \n##        163        163        143        156</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># drop rows with missing</span>\nna.omit<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 518 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 III        B                 3        8\n##  2 I          A                 4       10\n##  3 I          A                 9        1\n##  4 III        A                 8        8\n##  5 II         C                 2        9\n##  6 III        C                 7        1\n##  7 I          A                 9        6\n##  8 I          A                 2        4\n##  9 II         A                 1        9\n## 10 I          B                 9        2\n## # … with 508 more rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># drop rows with all missing</span>\ndf<span class=\"token punctuation\">[</span>rowSums<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>is.na<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">]</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1,000 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         &lt;NA&gt;              7        3\n##  5 I          A                 9        1\n##  6 III        A                10       NA\n##  7 III        A                 8        8\n##  8 &lt;NA&gt;       C                 2        7\n##  9 II         C                 2        9\n## 10 III        C                 7        1\n## # … with 990 more rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># drop columns with all missing</span>\ndf<span class=\"token punctuation\">[</span>colSums<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>is.na<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1,000 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         &lt;NA&gt;              7        3\n##  5 I          A                 9        1\n##  6 III        A                10       NA\n##  7 III        A                 8        8\n##  8 &lt;NA&gt;       C                 2        7\n##  9 II         C                 2        9\n## 10 III        C                 7        1\n## # … with 990 more rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># fill all missing by 0</span>\ndf <span class=\"token percent-operator operator\">%>%</span> replace<span class=\"token punctuation\">(</span>.<span class=\"token punctuation\">,</span> is.na<span class=\"token punctuation\">(</span>.<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1,000 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;\n##  1 I          0                 7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         0                 7        3\n##  5 I          A                 9        1\n##  6 III        A                10        0\n##  7 III        A                 8        8\n##  8 0          C                 2        7\n##  9 II         C                 2        9\n## 10 III        C                 7        1\n## # … with 990 more rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># fill missing by columns</span>\ndf <span class=\"token percent-operator operator\">%>%</span> replace_na<span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">(</span>dimension1 <span class=\"token operator\">=</span> <span class=\"token string\">\"Unknown\"</span><span class=\"token punctuation\">,</span> measure1 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1,000 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         &lt;NA&gt;              7        3\n##  5 I          A                 9        1\n##  6 III        A                10       NA\n##  7 III        A                 8        8\n##  8 Unknown    C                 2        7\n##  9 II         C                 2        9\n## 10 III        C                 7        1\n## # … with 990 more rows</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># count missing by columns</span>\ndf<span class=\"token punctuation\">.</span>isnull<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># drop any missing</span>\ndf<span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\"># drop rows with all missing</span>\ndf<span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span>how<span class=\"token operator\">=</span><span class=\"token string\">\"all\"</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\"># drop columns with all missing</span>\ndf<span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> how<span class=\"token operator\">=</span><span class=\"token string\">'all'</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token comment\"># fill all missing by 0</span>\ndf<span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># fill missing by columns</span>\ndf<span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"dimension1\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Unknown\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"measure1\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Unique</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># unique row</span>\ndf <span class=\"token percent-operator operator\">%>%</span> distinct<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 766 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         &lt;NA&gt;              7        3\n##  5 I          A                 9        1\n##  6 III        A                10       NA\n##  7 III        A                 8        8\n##  8 &lt;NA&gt;       C                 2        7\n##  9 II         C                 2        9\n## 10 III        C                 7        1\n## # … with 756 more rows</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># unique row by columns</span>\ndf <span class=\"token percent-operator operator\">%>%</span> distinct<span class=\"token punctuation\">(</span>dimension1<span class=\"token punctuation\">,</span> dimension2<span class=\"token punctuation\">,</span> .keep_all <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 16 x 4\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7\n##  2 III        B                 3        8\n##  3 I          A                 4       10\n##  4 II         &lt;NA&gt;              7        3\n##  5 III        A                10       NA\n##  6 &lt;NA&gt;       C                 2        7\n##  7 II         C                 2        9\n##  8 III        C                 7        1\n##  9 III        &lt;NA&gt;              5        4\n## 10 I          C                NA       10\n## 11 II         A                 1        9\n## 12 II         B                NA        2\n## 13 &lt;NA&gt;       A                 8       10\n## 14 I          B                 9        2\n## 15 &lt;NA&gt;       B                 9        4\n## 16 &lt;NA&gt;       &lt;NA&gt;              6       NA</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># unique row</span>\ndf<span class=\"token punctuation\">.</span>drop_duplicates<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># unique row by columns</span>\ndf<span class=\"token punctuation\">.</span>drop_duplicates<span class=\"token punctuation\">(</span>subset<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dimension1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dimension2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Level Count</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># distribution</span>\ntable<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>dimension1<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## \n##   I  II III \n## 295 275 267</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># contingency table</span>\ntable<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>dimension1<span class=\"token punctuation\">,</span> df<span class=\"token operator\">$</span>dimension2<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">##      \n##        A  B  C\n##   I   89 80 79\n##   II  71 89 70\n##   III 75 66 86</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># distribution</span>\ndf<span class=\"token punctuation\">.</span>dimension1<span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># contingency table</span>\npd<span class=\"token punctuation\">.</span>crosstab<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>dimension1<span class=\"token punctuation\">,</span> df<span class=\"token punctuation\">.</span>dimension2<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Summary</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># summarize the total, percent, ratio, and ratio</span>\n\ndf <span class=\"token percent-operator operator\">%>%</span> \n  group_by<span class=\"token punctuation\">(</span>dimension1<span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span> \n  summarise<span class=\"token punctuation\">(</span>\n    measure1 <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">(</span>measure1<span class=\"token punctuation\">,</span> na.rm <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    measure2 <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">(</span>measure2<span class=\"token punctuation\">,</span> na.rm <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    count <span class=\"token operator\">=</span> n<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span> \n  mutate<span class=\"token punctuation\">(</span>\n    measure1_percent <span class=\"token operator\">=</span> measure1<span class=\"token operator\">/</span>sum<span class=\"token punctuation\">(</span>measure1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    ratio <span class=\"token operator\">=</span> measure1<span class=\"token operator\">/</span>measure2\n  <span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span> \n  mutate<span class=\"token punctuation\">(</span>\n    ratio_relativity <span class=\"token operator\">=</span> ratio<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">(</span>measure1<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>sum<span class=\"token punctuation\">(</span>measure2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 4 x 7\n##   dimension1 measure1 measure2 count measure1_percent ratio\n##   &lt;chr&gt;         &lt;int&gt;    &lt;int&gt; &lt;int&gt;            &lt;dbl&gt; &lt;dbl&gt;\n## 1 &lt;NA&gt;            749      752   163            0.157 0.996\n## 2 I              1480     1460   295            0.311 1.01 \n## 3 II             1288     1261   275            0.271 1.02 \n## 4 III            1244     1320   267            0.261 0.942\n## # … with 1 more variable: ratio_relativity &lt;dbl&gt;</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># summarize the total, percent, ratio, and relativity</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">oneway</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>\n    pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"measure1\"</span><span class=\"token punctuation\">:</span> g<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"measure2\"</span><span class=\"token punctuation\">:</span> g<span class=\"token punctuation\">.</span>measure2<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"count\"</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"measure1_percent\"</span><span class=\"token punctuation\">:</span> g<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>df<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"ratio\"</span><span class=\"token punctuation\">:</span> g<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">.</span>measure2<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"ratio_relativity\"</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">.</span>measure2<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span> \n        <span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>measure1<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>df<span class=\"token punctuation\">.</span>measure2<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n  \ndf<span class=\"token punctuation\">.</span>groupby<span class=\"token punctuation\">(</span><span class=\"token string\">\"dimension1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">apply</span><span class=\"token punctuation\">(</span>oneway<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Merge</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># join tables with different key names</span>\ndf2 <span class=\"token operator\">&lt;-</span> df <span class=\"token percent-operator operator\">%>%</span>\n  group_by<span class=\"token punctuation\">(</span>dimension1<span class=\"token punctuation\">,</span> dimension2<span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span>\n  summarise<span class=\"token punctuation\">(</span>\n    measure3 <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">(</span>measure1<span class=\"token punctuation\">,</span> na.rm <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    measure4 <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">(</span>measure2<span class=\"token punctuation\">,</span> na.rm <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span>\n  rename<span class=\"token punctuation\">(</span>dimension3 <span class=\"token operator\">=</span> dimension1<span class=\"token punctuation\">,</span> dimension4 <span class=\"token operator\">=</span> dimension2<span class=\"token punctuation\">)</span>\n\nleft_join<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> df2<span class=\"token punctuation\">,</span>\n  by <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"dimension1\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"dimension3\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"dimension2\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"dimension4\"</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 1,000 x 6\n##    dimension1 dimension2 measure1 measure2 measure3 measure4\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;\n##  1 I          &lt;NA&gt;              7        7      229      195\n##  2 III        B                 3        8      314      337\n##  3 I          A                 4       10      461      480\n##  4 II         &lt;NA&gt;              7        3      226      180\n##  5 I          A                 9        1      461      480\n##  6 III        A                10       NA      353      356\n##  7 III        A                 8        8      353      356\n##  8 &lt;NA&gt;       C                 2        7      206      226\n##  9 II         C                 2        9      340      333\n## 10 III        C                 7        1      386      442\n## # … with 990 more rows</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># join tables with different key names</span>\npd<span class=\"token punctuation\">.</span>merge<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> df2<span class=\"token punctuation\">,</span>\n  how<span class=\"token operator\">=</span><span class=\"token string\">\"left\"</span><span class=\"token punctuation\">,</span> \n  left_on<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"dimesnion1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dimesnion2\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  right_on<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"dimesnion3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dimesnion4\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Reshape</h2>\n<h3>R</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># wide to long</span>\ndf_reshape <span class=\"token operator\">&lt;-</span> df <span class=\"token percent-operator operator\">%>%</span> gather<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"measure1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"measure2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                            key <span class=\"token operator\">=</span> <span class=\"token string\">\"measure\"</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"values\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># long to wide: the value must be unqiue by other variales</span>\ndf_reshape <span class=\"token percent-operator operator\">%>%</span>\n  group_by<span class=\"token punctuation\">(</span>dimension1<span class=\"token punctuation\">,</span> dimension2<span class=\"token punctuation\">,</span> measure<span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span>\n  summarise<span class=\"token punctuation\">(</span>values <span class=\"token operator\">=</span> sum<span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">,</span> na.rm <span class=\"token operator\">=</span> T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span> \n  spread<span class=\"token punctuation\">(</span>key <span class=\"token operator\">=</span> measure<span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> values<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## # A tibble: 16 x 4\n## # Groups:   dimension1, dimension2 [16]\n##    dimension1 dimension2 measure1 measure2\n##    &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;    &lt;int&gt;\n##  1 I          A               461      480\n##  2 I          B               392      426\n##  3 I          C               398      359\n##  4 I          &lt;NA&gt;            229      195\n##  5 II         A               282      358\n##  6 II         B               440      390\n##  7 II         C               340      333\n##  8 II         &lt;NA&gt;            226      180\n##  9 III        A               353      356\n## 10 III        B               314      337\n## 11 III        C               386      442\n## 12 III        &lt;NA&gt;            191      185\n## 13 &lt;NA&gt;       A               178      206\n## 14 &lt;NA&gt;       B               209      206\n## 15 &lt;NA&gt;       C               206      226\n## 16 &lt;NA&gt;       &lt;NA&gt;            156      114</code></pre></div>\n<h3>Python</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df_reshape <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>melt<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>\n                     id_vars<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'dimension1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dimension2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                     value_vars<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'measure1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'measure2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">(</span>df_reshape<span class=\"token punctuation\">.</span>groupby<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'dimension1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dimension2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'variable'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    as_index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n           <span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n           <span class=\"token punctuation\">.</span>pivot_table<span class=\"token punctuation\">(</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'dimension1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dimension2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        columns<span class=\"token operator\">=</span><span class=\"token string\">'variable'</span><span class=\"token punctuation\">,</span> values<span class=\"token operator\">=</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"Often-used Scripts","date":"February 06, 2018","description":"This is a set of often-used scripts for data wrangling."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/commonly-used_scripts/","previous":null,"next":null}}}